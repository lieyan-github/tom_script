# 更新日志

> 作者: tom  
> lie_yan@126.com

---
## 待添加/优化的内容:
---

* 为热键加入 event_keypress 事件响应
* 待优化 批量处理, 识别重命名av文件和文件夹
* 待优化 修改rename流程, 进行优化
* av识别特殊情况 1pon-42718_676
* 待增加 词法分析
  
---

### 2020-12-22 18:16:41

* 更新内容:
    - 修改 user_hotkeys.ahk
      - 增加 热键 >!,
        - 输出19位短id -- "2020-12-22 18_13_21" 下划线间隔 
    - 修改 [tom实用工具] ffmpeg视频处理GUI.ahk
      - 修改 ui界面 
        - 修改 选中已存在的json设置文件, 自动恢复设置内容
          - 增加json中源文件目录失效, 自动在json当前目录下查找指定视频源文件, 存在则更新路径 
          - 选中配置文件使用快捷键, 可恢复配置, 并打开视频源文件目录 
          - 选中视频文件, 操作不变

---

### 2020-11-16 13:46:45

* 更新内容:
    - 修改global_操作控制中心.ahk
        - 增加 #esc 打开ffmpeg视频处理GUI 
    - 修改 [tom实用工具] ffmpeg视频处理GUI.ahk
      - 修改 ui界面 
        - 增加 按钮[保存设置] 保存为json文件
        - 增加 根据已存在的json设置文件, 自动恢复设置内容
    - 修改 File.class.ahk
      - 调整 jsonfile函数 
        - 默认文件编码utf-8 减少变量依赖
    - 修改 Array.ahk
      - 增加 arrayStrFill函数 减少string依赖

---

### 2020-11-14 16:43:59

* 更新内容:
    - 修改 Av.class.ahk
      - 修改 av_csv查询(..) 
        - 增加 参数in初始行内容格式, 为新数据设置初始输入格式 
    - 修改 全部av数据库文件 为csv扩展名
        - db_av....txt -> db_av....csv
    - 修改global_操作控制中心.ahk
        - 修改 #q::打开搜索菜单() 
          - 增加 搜索potplayer标题中的文件名(含扩展名)
        - 增加全部 Capslock 组合键
            - 并对无功能快捷键 添加 提示热键无操作()  
        - 取消 AppsKey 组合键
    - 修改 lib_搜索.ahk
        - 增加快速编辑搜索器
          - 按shift 同时按菜单, 编辑cmd和参数,逗号间隔
        - 增加 搜索菜单项 recentSearcher 最近使用的搜索器 
            - 快捷键 ``
            - 暂时只能记录本地搜索器和网络搜索引擎
                - 待添加 内部搜索函数记录的功能 
        - 修正 运行搜索器(_searchKey, _searcher)
            - 参数: _searcher  
                - name:""..."", 
                - cmd:"...", 
                - args:"..." 
                    - 参数中关键字用 "{1}" 代替 
                - log: false/true
                    - 是否记入日志
            - 无搜索关键字, 则只打开path路径或url
            - q 直接可本地搜索 或 打开everything


---
## 已提交的内容:


---

### 2020-09-19 02:58:17

* 更新内容:
    - 修改ffmpeg视频处理GUI.ahk
        - 修正 函数ffmpeg剪切视频()
            - 对输出文件名限制80个字符
            - 保存修正后的剪切任务, 到输出目录;
                - 文件名: 剪切视频_源文件名.log
            - 时间段字符串容错更宽松
                - 符合间隔格式 00.00.00.000 或者 0.0.0.0 
                - 识别并转换为标准格式 00:00:00.000

    - 更改剪贴板数组操作快捷键
        - 修改 global_操作控制中心.ahk
            - 增加快捷键
                - +#Enter 快速打开字符串目录
                - #Enter  快速打开字符串文件
            
            - 改快捷键  
                - Capslock & x  
                - Capslock & c
                - Capslock & v
                - Capslock & z
                - +Capslock::Clipboarder.clean()
                - 删除 win + space

---

###  2020-05-23 03:55:03

* 更新内容:
    - 修改 Av.class.ahk 
        - 修改函数 av_csv查询, av_csv数据行修改_api
            - 加入参数 a_行关键字合法性检查函数名
                - 解决行关键字不合法问题  
        - 增加函数 检查_av查询_作品_行关键字 检查_av查询_女优_行关键字
            - 暂时以是否包含数字区别, 女优名不含数字, 作品编号含数字   

    - 修改 Config.class.ahk
        - 增加 日志类Log
            - add() 添加日志
            - print() 显示日志并清空日志
            - clear() 清空日志
        - 增加 类Debug
            - add() 添加Debug日志
            - print() 显示Debug日志并清空Debug日志列表
            - clear() 清空Debug日志    

    - 修改 user_hotkey.ahk
        - 增加 快捷键 ^#+a 和 ^#+z 快速输出tags格式的帮助说明    

    - 修改 lib_文件目录管理.ahk
        - 增加 正则列表匹配_批量重命名文件或目录() 可以使用[{..},{..}], 批量正则批量
        - 修改 快捷批量重命名文件或目录, 判断输入参数, 以适配批量正则列表匹配处理    

    - 修改 global_操作控制中心.ahk
        - 增加快捷键 ^#r 批量正则列表匹配重命名 
        - 增加快捷键 !#f
            - 用于收集多个带有序号_xxx的图片到同一个作品编号名目录下
        - 修改快捷键 ^#f 改为 ^+#f

---

###  2020-04-16 23:11:37

* 更新内容:
    - 纠正错误
        - 修复 Path.class.ahk 
            - 针对目录名保护".", 解析file和ext错误的问题        

    - 修改 user_hotkey.ahk
        - 增加 快捷键 #+a 和 #+z 快速输出tags的格式
        - 修改 tags格式输出规范, 并添加说明提示    

    - 修改 Av.class.ahk
        - 增加 函数 Av.get_tags格式(_type)  获取tags的格式和说明, 
            - 进一步规范tags的格式划分
        - 增加 函数 Av.get_tags_json(_type)    

    - 修改config.json
        - 增加 用户文件 "tags_av": "tags_av.json" 

---

###  2020-04-15 19:21:22

* 更新内容:
    - 纠正错误
        - lib_文件目录管理.ahk
            - 510行 StrReplace(_新文件名, "{clipboard}", Clipboard) 
                - 替换内容修改为Clipboard
                - 修正一些其他小细节

---

### 2020-04-15 05:06:05 

* 更新内容:
    - 修改 Clipboarder.class.ahk 
        - 增加菜单 Lab_查看剪贴板对象内容    

    - 修改 lib_文件目录管理.ahk
        - 添加 函数
            - 快捷批量重命名文件或目录
            - 批量重命名文件或目录
            - 自动重命名单文件或目录    

    - 修改 global_操作控制中心.ahk
        - 修改 ^+r 和 +f2 为统一的无限undo功能

---

### 2020-04-13 17:01:44

* 更新内容:
    - 修改 Av.class.ahk
        - 增加 函数 
            - av_csv数据行修改 直接添加/修改功能
            - av_csv数据行修改_api
            - av作品_csv数据行修改_api,   
            - av女优_csv数据行修改_api
            - av数据捕捉_api(_in输入数据, _in操作类型)    

    - 修改 Clipboarder.class.ahk
        - 增加 static undoList     

    - 修改 Menu.class.ahk
        - 增加 选项 编辑Config.rename_regexMatch和Replace    

    - 修改 Config.class.ahk
        - 增加 静态变量 rename_regexMatch, rename_regexReplace    

    - 修改 global_操作控制中心.ahk
        - 修改 ^r 参数改为正则表达式重命名 
        - 添加 #f:: 快速收集选中文件到指定目录
        - 添加 ^#f:: av目录文件收集整理    

    - 修改 lib_文件目录管理.ahk
        - 添加 函数 
            - 根据特征分组, 
            - 快速收集特征文件到目录_单目录, 
            - 收集特征文件到目录_单目录 
            - 快速收集选中文件到指定目录, 
            - 收集文件到指定目录         

        - 修改 自动重命名, f2自动重命名, fileRename三个函数
            - 默认使用正则表达式匹配替换文件名, 
            - 增加输入参数: _regexMatch, _regexReplace 
            - fileRename 函数 undo操作使用Clipboarder.undoList存储

---

### 2020-04-05 18:03:38 

* 更新内容:
    - 修改 global_操作控制中心.ahk
        - 添加 alt + RButton 快捷复制窗口标题
        - 修改 win + f4 操作改为 run ffmpeg视频处理gui.ahk文件
    - 修改 [tom实用工具]ffmpeg视频处理gui.ahk
        - 增加 第12行 ffmpeg视频处理gui() 以独立ahk文件执行

---

### 2019-12-29 01:46:22

* 更新内容:
    - 修改 global_操作控制中心.ahk
        - 增加 快捷复制选中内容(按下左键同时按下右键)    

    - 修改 Clipboard.class.ahk
        - 增加 从剪贴板文件名_获取多文件文本内容_到剪贴板()
        - 增加 提取文件文本内容(_path, _encoding:= "utf-8")
        - 增加 剪贴板菜单选项 "剪贴板文件名⋙内容⋙剪贴板"

---

### 2019-12-16 15:53:21

* 更新内容:
    - 修改 global_操作控制中心.ahk
        - 增加 ctrl+win+f1 ahk本地帮助
        - 增加 ctrl+shift+win+f1 ahk官方在线帮助    

    - 修改 Av.class.ahk 
        - 添加 av_查询已看过(_查询av关键字)
            - 根据查询关键字区分, 查询已看过作品/女优
        - 添加 av_csv查询(...)
            - 优化重构 查询已看过作品/女优 两个函数
            - 用_in分析函数名 回调函数 作为参数 分析提取用户输入内容  

    - 修改 lib_搜索.ahk
        - 简化已看过的av查询
            - 添加 av已看过的AV资料
            - 删除两项 已看过的av作品/女优

---

### 2019-11-07 22:42:06

* 更新内容:
    - 修改 global_操作控制中心.ahk
        - 增加 快捷键^#RButton 打开脚本主目录
    
    - 修改 Av.class.ahk 
        - 完善对av作品字符串的解析  已完成
        - 修改函数 rename(...)     已完成
            - 调整 首先检查是否已格式化的格式, 然后再考虑其他情况
    
    - 修改 lib_正则表达式.ahk 已完成
        - 添加正则表达式 模板库 class 正则表达式{..}
            - 建立正则表达式模板库, 通过名称索引专用正则表达式
            - 获取正则表达式方法: 正则表达式.模板("日期")
    
    - 修改lib_字符串处理.ahk 已完成
        - 修改 strFixDate(_dateStr) 
            - 使用 正则表达式.模板("日期") 匹配
    
    - 修改lib_文件目录管理.ahk 已完成
        - 解决!f2 会带有多余文件扩展名的bug 
            - 修改bug fileRename(..) 不再返回文件扩展名
            - f2自动重命名(...) 删除send ^a全选操作

---

### 2019-10-28 05:15:58

* 更新内容:
    - 修改bug Av.class.ahk 并对提示信息进行一些优化

---

### 2019-10-26 03:46:10

* 更新内容:
    - 修改bug Av.class.ahk 并进行一些优化
        - 行1407, return修改为break

---

### 2019-10-26 00:45:09

* 更新内容:
    - 修改bug Av.class.ahk 并进行一些优化
        - 对input输入空值的情况,进行处理

---

### 2019-10-25 16:51:58

* 更新内容:
    - 修改bug Av.class.ahk 并进行一些优化
        - 修改函数 av作品_查询已看过(_in查询av编号) 
            - 对input输入内容, 首先进行小写字母转换
        - 修改函数 av女优_查询已看过(_in查询av女优名)
            - 对input输入内容, 首先进行小写字母转换

---

### 2019-10-25 05:10:23

* 更新内容:
    - Av.class.ahk
        - 修改函数 av女优_查询已看过(_in查询av女优名)
            - 对input输入的含"#av女优#"的格式化女优信息, 直接进行解析

---

### 2019-10-25 04:52:51

* 更新内容:
    - Av.class.ahk
        - 修改函数 av女优_查询已看过(_in查询av女优名)
            - 对input输入的含★的格式化女优信息, 直接进行解析

---

### 2019-10-25 04:06:26

* 更新内容:
    - Av.class.ahk
        - 添加函数 av作品_查询已看过(_in查询av编号) 
            - 返回值: -1 失败, >0 存在已看过作品
            - userdata文件每行格式: "av编号(key), 评级(0烂片-3精品), 演员(可空 空格间隔), 标签(可空 空格间隔)"
            - config.json["data_user"]["已看过的av作品"]
        - 添加函数 av女优_查询已看过(_in查询av女优名)
            - 返回值: -1 失败, >0 存在已看过女优
            - userdata文件每行格式: 女优名(key), 评分(0烂-3精品), 生日(可空), 罩杯(a-z), 标签(可空 空格间隔)"
            - config.json["data_user"]["已看过的av女优"]
    - lib_搜索.ahk
        - 修改函数 search_menu()
            - 添加选项 &a. 已看过的AV女优
            - 添加选项 &z. 已看过的AV作品

---

### 2019-09-03 14:12:58

* 更新内容:
    - Clipboarder.class.ahk
        - 修改函数: Clipboarder.join()
            - 针对视频时间识别的字符串拼接 00:33:37.048

---

### 2019-08-25 18:53:23

* 更新内容:
    - [tom实用工具] ffmpeg视频处理GUI.ahk
        - 修改函数: ffmpeg视频处理gui()
            - 清除 变量"剪切时间列表"两端的多余逗号 

---

### 2019-08-25 02:59:59

* 更新内容:
    - \scripts\libs\lib_文件目录管理.ahk
        - 修改函数: 备份文件到多目录_有后缀(...)
            - 备份文件加后缀名, 并且可限备份数, 默认3 
            - 文件顺序按文件名排序
        
        - 添加函数: 备份文件到多目录(...) 
            - 保持源文件名

---

### 2019-08-23 14:05:50

* 更新内容:
    - \scripts\libs\lib_文件目录管理.ahk
        - 修改bug: getDirPath(_FullFileName)
            - 如果_FullFileName本身就是目录, 则直接返回_FullFileName

---

### 2019-08-23 01:34:54

* 更新内容:
    - \scripts\libs\lib_文件目录管理.ahk
        - getFilesLongPathList函数更名为getFilesFromDir, 并对函数进行更新;
        - getFilesNameList函数更名为getFilesNameFromDir, 并对函数进行更新;
        - 添加getSubDirs(_dir, _filePatterns, _includeChildFolders:="");

---

### 2019-08-16 01:59:52 

* 更新内容:
    - \scripts\libs\lib_字符串处理.ahk
        - strClean 默认清洗字符加入"_"

---

### 2019-08-02 01:18:10  

* 更新内容:
    - 添加*快捷键说明.md*
    - scripts/专用脚本增加
        - [tom实用工具] sublimeText操作.ahk

---

### 2019-07-10 23:33:36

* 更新内容:
    - lib_文件目录管理.ahk
        - 添加函数: 打开文件操作菜单()
        - #f8  打开文件操作菜单()
            - 整合: 打开同步目录  
            - 整合: 备份360极速浏览器的bookmarks

---

### 2019-07-10 20:43:52

* 更新内容:    
    - lib_文件目录管理.ahk        
        - 修正函数 GetIniFileSection
        - 修正函数 GetIniFileALLSectionsTitle
        - 绑定热字符串 ;help 显示代码帮助

---

### 2019-07-10 02:41:22

* 更新内容:
    - lib_文件目录管理.ahk
        - 加入函数备份文件到多目录(备份源文件, 备份目录列表)
        - 绑定 ctrl + win + f8 备份360极速浏览器的bookmarks
    - 修正一些ffmpeg视频处理GUI.ahk小错误

---

### 2019-07-05 23:41:07

* 更新内容:
    - 专用脚本目录增加 [tom实用工具] ffmpeg视频处理GUI.ahk
        - ffmpeg视频处理gui() 绑定快捷键 win+f4 
        - ffmpeg剪切视频
        - ffmpeg修改视频分辨率

---

### 2019-07-01 00:09:32

* 更新内容:
    - 大的改动, 完善了单元测试功能
        - 重写了TestUnit.class.ahk, 简化单元测试操作
        - 增加 test_init(), test_add(....), test_run(), assert(...) 主要的单元测试函数;
        - 增加scripts/testUnit目录, 专用于单元测试, 并添加"单元测试.ahk";
        - 把所有测试都集中放在"单元测试.ahk"文件中;
        - 单元测试快捷键 ctrl + win + f12
    
    - 小的调整
        - alt + ; 当前日期时间
        - alt + . 日期
        - alt + / 时间
        - alt + ' id

* 待解决的修改:
    - av识别和重命名
    - inWinList() 窗口列表模式待完善

---

### 2019-05-29 17:40:15

* 更新内容:
    - 修改allowResizeWins.json结构, 简化为文件exe名的数组形式, 检测窗口白名单使用exe检测, 不再使用ahk_class检测
    - 修改窗口管理, inWinList(), 添加窗口到白名单(), 从白名单删除窗口()
    - 添加arrayRemoveByValue()

* 发现问题:
    - 需要在白名单列表中, 数组项中加入类型, 格式为 "win类型,winTitle"
    - av收藏夹重命名, av搜索识别异常, 竟然把已格式化的作品识别为av搜索

---

### 2019-04-11 18:22:15

* 更新内容:
    - 修改时间的快捷键,
        - #; 当前时间
        - ^#; 日期
        - +#; 时间
        - !#; id
    
    - 增加剪贴板内容字数统计;
    - 数组列表arrayToStr(), 修正key为等宽格式显示
    - 数组显示arrayPrint()

---

### 2019-02-24 23:28:52

* 更新内容:
    - 修改剪贴板菜单启动方式, ctrl+space和ctrl+RButton;
    - 增加剪贴板清洗选择功能, ctrl+点选;
    - 修改批量启动和批量关闭, 使用json格式数据, 放在userdata目录;
    - 修改AV提取数据的方式, 以特征列表循环代替一次性的正则匹配;

* 待解决的修改:
    - test单元测试的方式
